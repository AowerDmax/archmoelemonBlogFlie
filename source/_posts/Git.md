---
title: Git
date: 2019-07-21 12:31:28
tags:
- git
- 版本管理
- 实用小工具
---

Git是一个版本管理的工具， 他可以在

### Git与svn对比

#### svn

svn是集中式版本控制系统， 版本库是集中放在中央服务器， 而干活的时候， 用的都是自己的电脑， 所以首先要从中央服务器那里得到最新的版本， 然后干活， 干完后， 需要把自己做完的活推送到中央服务器。集中式版本控制系统是必须联网才能工作， 如果在局域网还可以， 带宽够大， 速度够快， 如果在互联网下， 如果网速慢的话， 就郁闷了。

集中管理方式在一定程度看到其他开发人员在什么， 而管理员也可以很轻松掌握每个人的开发权限

但是相较于其优点而言， 集中式版本控制工具缺点很明显

* 服务器单点故障
* 容错性差

#### Git

Git是分布式版本控制系统， 那么它就没有中央服务器的， 每个人的电脑上就是一个完整的版本库， 这样， 工作的时候就不需要联网了， 因为版本都是在自己的电脑上， 既然每个人的电脑上都有一个完整的版本库， 那多个人如何协作呢？比如说自己在电脑上改了文件A， 其他人也在电脑上改了文件A， 这时， 你们两之间只需把各自的修改推送给对方， 就可以互相看到对方的修改了

### git工作流程

1. 从远程仓库中克隆Git资源作为本地仓库
2. 从本地仓库中cheekout代码然后进行代码修改
3. 在提交前先将代码提交到暂存区
4. 提交修改， 提交到本地仓库， 本地仓库中保存修改的各个历史版本
5. 在修改完成后， 需要和团队成员共享代码时， 可以将代码push到远程仓库

### Git的安装

默认选项无需更改

推荐安装到默认的安装路径

git bash here 会打开一个命令行窗口， 里面的Linux命令都适用

```git
git --version
#可以看到当前安装的git的版本信息·
```

### Git的基本使用

### 小结

现在总结一下今天学的两点内容：

初始化一个Git仓库，使用`git init`命令。

添加文件到Git仓库，分两步：

1. 使用命令`git add <file>`，注意，可反复多次使用，添加多个文件；
2. 使用命令`git commit -m <message>`，完成。

### 小结

- 要随时掌握工作区的状态，使用`git status`命令。

- 如果`git status`告诉你有文件被修改过，用`git diff`可以查看修改内容。

- `git log`命令显示从最近到最远的提交日志，我们可以看到3次提交，最近的一次是`append GPL`，上一次是`add distributed`，最早的一次是`wrote a readme file`。

  如果嫌输出信息太多，看得眼花缭乱的，可以试试加上`--pretty=oneline`参数：

* `cat <filename>`在命令行窗口中打开你想要的文件

### 小结

现在总结一下：

- `HEAD`指向的版本就是当前版本，因此，Git允许我们在版本的历史之间穿梭，使用命令`git reset --hard commit_id`。
- 穿梭前，用`git log`可以查看提交历史，以便确定要回退到哪个版本。
- 要重返未来，用`git reflog`查看命令历史，以便确定要回到未来的哪个版本。

### 小结

现在总结一下：

* git diff比较的是工作目录中当前文件和暂存区域快照之间的差异， 也就是修改之后还没有暂存起来的变化内容。若要查看已暂存的将要添加到下次提交里的内容，可以用 git diff --cached 命令。

  请注意，git diff 本身只显示尚未暂存的改动，而不是自上次提交以来所做的所有改动。 所以有时候你一下子暂存了所有更新过的文件后，运行 git diff 后却什么也没有，就是这个原因。

* 暂存区是Git非常重要的概念，弄明白了暂存区，就弄明白了Git的很多操作到底干了什么。

### 小结

现在总结一下

* 提交后，用`git diff HEAD -- readme.txt`命令可以查看工作区和版本库里面最新版本的区别：
* 每次修改，如果不用`git add`到暂存区，那就不会加入到`commit`中。

### 小结

现在总结一下

* 一种是`readme.txt`自修改后还没有被放到暂存区，现在，撤销修改就回到和版本库一模一样的状态；

  一种是`readme.txt`已经添加到暂存区后，又作了修改，现在，撤销修改就回到添加到暂存区后的状态。

  总之，就是让这个文件回到最近一次`git commit`或`git add`时的状态。

* `git checkout -- file`命令中的`--`很重要，没有`--`，就变成了“切换到另一个分支”的命令，我们在后面的分支管理中会再次遇到`git checkout`命令。

### 小结

又到了小结时间。

* 当你改乱了工作区某个文件的内容，想直接丢弃工作区的修改时，用命令`git checkout -- file`。

* 当你不但改乱了工作区某个文件的内容，还添加到了暂存区时，想丢弃修改，分两步，第一步用命令`git reset HEAD <file>`，就回到了场景1，第二步按场景1操作。

* 已经提交了不合适的修改到版本库时，想要撤销本次提交，参考[版本回退](https://www.liaoxuefeng.com/wiki/896043488029600/897013573512192)一节，不过前提是没有推送到远程库。

### 小结

又到了小结时间

* 命令`git rm`用于删除一个文件。如果一个文件已经被提交到版本库，那么你永远不用担心误删，但是要小心，你只能恢复文件到最新版本，你会丢失**最近一次提交后你修改的内容**。

* 一般情况下，你通常直接在文件管理器中把没用的文件删了，或者用`rm`命令删了：

* 确实要从版本库中删除该文件，那就用命令`git rm`删掉，并且`git commit`：

* 另一种情况是删错了，因为版本库里还有呢，所以可以很轻松地把误删的文件恢复到最新版本：

  ```git
  $ git checkout -- test.txt
  ```

### 小结

又到了小结时间

* 如果一切顺利的话，可以在用户主目录里找到`.ssh`目录，里面有`id_rsa`和`id_rsa.pub`两个文件，这两个就是SSH Key的秘钥对，`id_rsa`是私钥，不能泄露出去，`id_rsa.pub`是公钥，可以放心地告诉任何人。
* 为什么GitHub需要SSH Key呢？因为GitHub需要识别出你推送的提交确实是你推送的，而不是别人冒充的，而Git支持SSH协议，所以，GitHub只要知道了你的公钥，就可以确认只有你自己才能推送。

* 当然，GitHub允许你添加多个Key。假定你有若干电脑，你一会儿在公司提交，一会儿在家里提交，只要把每台电脑的Key都添加到GitHub，就可以在每台电脑上往GitHub推送了。

* 最后友情提示，在GitHub上免费托管的Git仓库，任何人都可以看到喔（但只有你自己才能改）。所以，不要把敏感信息放进去。

* 如果你不想让别人看到Git库，有两个办法，一个是交点保护费，让GitHub把公开的仓库变成私有的，这样别人就看不见了（不可读更不可写）。另一个办法是自己动手，搭一个Git服务器，因为是你自己的Git服务器，所以别人也是看不见的。这个方法我们后面会讲到的，相当简单，公司内部开发必备。

* 确保你拥有一个GitHub账号后，我们就即将开始远程仓库的学习。



